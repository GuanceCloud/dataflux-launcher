{% extends "base.html" %}

{% block content %}

<div class="row form-body">
    <form id="validateForm" class="form-horizontal" onsubmit="return false;">
      <h2 class="page-heading">{{ title }}</h2>

      <div class="high-block">
        <h4>后台管理员</h4>
        <div class="form-group">
          <label for="iptUserName" class="col-sm-2 control-label">管理员账号:</label>
          <div class="col-sm-5">
            <input type="text" class="form-control" id="iptUserName" name="userName" required value="{{ pageData.other.manager.username }}" placeholder="后台管理员账号">
          </div>
          <div class="col-sm-5 error"></div>
        </div>
        <div class="form-group">
          <label for="iptUserEmail" class="col-sm-2 control-label">管理员邮箱:</label>
          <div class="col-sm-5">
            <input type="email" class="form-control" id="iptUserEmail" name="userEmail" required value="{{ pageData.other.manager.email }}" placeholder="管理员邮箱">
          </div>
          <div class="col-sm-5 error"></div>
        </div>
      </div>

      <div class="high-block">
        <h4>Studio 配置</h4>
        <div class="form-group">

          <label for="iptHideHelp" class="col-sm-2 control-label">Studio 帮助链接:</label>
          <div class="col-sm-7">
            <label class="checkbox-inline">
              {% if pageData.other.studioHideHelp %}
              <input type="checkbox" id="ckbStudioHideHelp" checked="checked"> 隐藏帮助链接
              {% else %}
              <input type="checkbox" id="ckbStudioHideHelp"> 隐藏帮助链接
              {% endif %}
            </label>
          </div>
          <div class="col-sm-3 error"></div>
        </div>
      </div>

      <div class="high-block">
        <h4>拨测服务</h4>
        <div class="form-group">

          <label for="iptHideHelp" class="col-sm-2 control-label">拨测服务中心选择:</label>
          <div class="col-sm-7">
            {% if pageData.other.dialService %}
            <label class="checkbox-inline">
              <input type="radio" name="privateDialtesting" value="buildin" checked="checked"> 内置的拨测服务中心
            </label>
            <label class="checkbox-inline">
              <input type="radio" name="privateDialtesting" value="saas"> 观测云 SaaS 拨测服务中心
            </label>
            {% else %}
            <label class="checkbox-inline">
              <input type="radio" name="privateDialtesting" value="buildin"> 内置的拨测服务中心
            </label>
            <label class="checkbox-inline">
              <input type="radio" name="privateDialtesting" value="saas" checked="checked"> 观测云 SaaS 拨测服务中心
            </label>
            {% endif %}
          </div>
          <div class="col-sm-3 error"></div>
        </div>
      </div>

      <div class="high-block">
        <h4>集群节点内网 IP</h4>
        <div class="form-group">
          <label for="iptUserEmail" class="col-sm-2 control-label">IP 地址:</label>
          <div class="col-sm-5">
            <input type="text" class="form-control" id="iptNodeIps" name="nodeIps" required value="{{ pageData.other.nodeInternalIP }}" placeholder="IP 地址">
          </div>
          <div class="col-sm-5 error"></div>
        </div>

        <div class="form-group">
          <label for="iptUserName" class="col-sm-2 control-label">&nbsp;</label>
          <div class="col-sm-5">
            <p class="form-control-static text-danger"><strong>集群节点内网 IP，多个 IP 使用 “;” 分隔！</strong></p>
          </div>
        </div>
      </div>
      
      <div class="high-block">
        <h4>系统域名</h4>
        <div class="form-group">
          <label for="iptDomain" class="col-sm-2 control-label">主域名:</label>
          <div class="col-sm-5">
            <input type="text" class="form-control" id="iptDomain" name="host" required value="{{ pageData.domain.domain }}" placeholder="系统主域名，如：dataflux.cn">
          </div>
          <div class="col-sm-5 error"></div>
        </div>
        <div class="form-group sub-domain-group">
          <label for="iptConsoleDomain" class="col-sm-2 control-label">子域名:</label>
          <div class="col-sm-5">
            <p>
              <span class="form-control-static"></span>
              <input type="text" class="form-control" style="display: inline-block;  width: 180px;" id="iptConsoleDomain" name="console" required value="{{ pageData.domain.subDomain.console }}" placeholder="Studio 前端站点">
              <span class="form-control-static main-domain">.{{ pageData.domain.domain }}</span>
            </p>
            <p>
              <span class="form-control-static"></span>
              <input type="text" class="form-control" style="display: inline-block;  width: 180px;" id="iptConsoleApiDomain" name="consoleApi" required value="{{ pageData.domain.subDomain.consoleApi }}" placeholder="Studio 后端 API">
              <span class="form-control-static main-domain">.{{ pageData.domain.domain }}</span>
            </p>
            <p>
              <span class="
              orm-control-static"></span>
              <input type="text" class="form-control" style="display: inline-block;  width: 180px;" id="iptManagementDomain" name="management" required value="{{ pageData.domain.subDomain.management }}" placeholder="管理后台">
              <span class="form-control-static main-domain">.{{ pageData.domain.domain }}</span>
            </p>
            <p>
              <span class="form-control-static"></span>
              <input type="text" class="form-control" style="display: inline-block;  width: 180px;" id="iptManagementApiDomain" name="managementApi" required value="{{ pageData.domain.subDomain.managementApi }}" placeholder="管理后台 API">
              <span class="form-control-static main-domain">.{{ pageData.domain.domain }}</span>
            </p>
            <p>
              <span class="form-control-static"></span>
              <input type="text" class="form-control" style="display: inline-block;  width: 180px;" id="iptDocsDomain" name="docs" required value="{{ pageData.domain.subDomain.docs }}" placeholder="帮助中心站点">
              <span class="form-control-static main-domain">.{{ pageData.domain.domain }}</span>
            </p>
            <p>
              <span class="form-control-static"></span>
              <input type="text" class="form-control" style="display: inline-block;  width: 180px;" id="iptOpenApiDomain" name="openApi" required value="{{ pageData.domain.subDomain.openApi }}" placeholder="Open API">
              <span class="form-control-static main-domain">.{{ pageData.domain.domain }}</span>
            </p>
            <!-- <p>
              <span class="form-control-static"></span>
              <input type="text" class="form-control" style="display: inline-block;  width: 180px;" id="iptWebSocketDomain" name="websocket" required value="{{ pageData.domain.subDomain.websocket }}" placeholder="dataflux websocket">
              <span class="form-control-static main-domain">.{{ pageData.domain.domain }}</span>
            </p> -->
            <p>
              <span class="form-control-static"></span>
              <input type="text" class="form-control" style="display: inline-block;  width: 180px;" id="iptFuncDomain" name="function" required value="{{ pageData.domain.subDomain.function }}" placeholder="dataflux Function">
              <span class="form-control-static main-domain">.{{ pageData.domain.domain }}</span>
            </p>
            <p>
              <span class="form-control-static"></span>
              <input type="text" class="form-control" style="display: inline-block;  width: 180px;" id="iptStaticResourceDomain" name="staticResource" required value="{{ pageData.domain.subDomain.staticResource }}" placeholder="guance static resource">
              <span class="form-control-static main-domain">.{{ pageData.domain.domain }}</span>
            </p>
            <p>
              <span class="form-control-static"></span>
              <input type="text" class="form-control" style="display: inline-block;  width: 180px;" id="iptDialtestingDomain" name="dialtesting" required value="{{ pageData.domain.subDomain.dialtesting }}" placeholder="拨测服务中心">
              <span class="form-control-static main-domain">.{{ pageData.domain.domain }}</span>
            </p>
            <p>
              <span class="form-control-static"></span>
              <input type="text" class="form-control" style="display: inline-block;  width: 180px;" id="iptKodoDomain" name="kodo" required value="{{ pageData.domain.subDomain.kodo }}" placeholder="dataflux kodo">
              <span class="form-control-static main-domain">.{{ pageData.domain.domain }}</span>

              <span>&nbsp;&nbsp;</span>
              <label class="form-control-static">
                {% if pageData.domain.kodoLoadBalancerType == "internet" %}
                <input type="checkbox" id="ckbKodoLBType" /> Kodo 使用私网 LoadBalancer（与 DataWay 在同一个内网）
                {% else %}
                <!-- 默认为私网类型的 LoadBalancer -->
                <input type="checkbox" id="ckbKodoLBType" checked="checked" /> Kodo 使用私网 LoadBalancer（与 DataWay 在同一个内网）
                {% endif %}
              </label>
            </p>
          </div>
          <div class="col-sm-5 error"></div>
        </div>
      </div>

      <div class="high-block">
        <h4>
          <label class="checkbox-inline" style="font-weight: bold;">
            {% if pageData.other.tls.tlsDisabled %}
            <input type="checkbox" id="ckbTlsEnabled" onchange="setup.tls_status_change(this)" > 启用 TLS 证书（只支持 PEM 格式的证书）
            {% else %}
            <input type="checkbox" id="ckbTlsEnabled" onchange="setup.tls_status_change(this)" checked="checked"> 启用 TLS 证书（只支持 PEM 格式的证书）
            {% endif %}
          </label>
        </h4>
        <div class="form-group">
          <div class="col-sm-6">私钥:</div>
          <div class="col-sm-6">证书:</div>
        </div>
        <div class="form-group certificate-text">
          <div class="col-sm-6">
            <textarea id="certificatePrivateKey" {{ "disabled" if pageData.other.tls.tlsDisabled }} class="monospaced" required name="certificatePrivateKey" placeholder="输入私钥，以-----BEGIN RSA PRIVATE KEY-----开头">{{ pageData.other.tls.certificatePrivateKey }}</textarea>
          </div>
          <div class="col-sm-6">
            <textarea id="certificateContent" {{ "disabled" if pageData.other.tls.tlsDisabled }} class="monospaced" required name="certificateContent" laceholder="输入证书，以-----BEGIN CERTIFICATE-----开头">{{ pageData.other.tls.certificateContent }}</textarea>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label class="col-sm-2 control-label">&nbsp;</label>
        <div class="col-sm-10">
            <button class="btn btn-primary" onclick="setup.other_config()">
              下一步
            </button>
            <a class="btn btn-default" href="/install/influxdb">上一步</a>
        </div>
      </div>
    </form>
</div>

<script type="text/javascript">
  $().ready(function(){
    $('#iptDomain').on('keyup', function(){
        $('.sub-domain-group .main-domain').text( '.' + $(this).val() );
    });
  });
</script>

{% endblock %}
